{% extends 'base.html' %}

{% block body %}
  <h1>Delete Task</h1>
  <p>Are you sure you want to delete this task?</p>
  <p>Task: {{ task.title }}</p>
  <form method="post" action="{{ url_for('tasks_aka_cookies.delete_task', id=task.id) }}" id="delete-task-form">
    <input type="hidden" name="_method" value="DELETE">
    <input type="submit" value="Yes, delete it">
  </form>
  <p><a href="{{ url_for('tasks_aka_cookies.index') }}">Cancel</a></p>
  <script>
    const form = document.querySelector('#delete-task-form');
    form.addEventListener('submit', (event) => {
      event.preventDefault();
      const url = form.getAttribute('action');
      const method = form.querySelector('input[name="_method"]').value;
      fetch(url, { method })
        .then(response => {
          if (response.redirected) {
            window.location.href = response.url;
          }
        });
    });
  </script>

{% endblock %}